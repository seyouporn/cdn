!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((e=e||self).flowplayer=e.flowplayer||{},e.flowplayer.cuepoints=n())}(this,(function(){"use strict";var e={MOUNT:"mount",ERROR:"error",CONTEXT_MENU:"contextmenu",CLICK:"click",DBL_CLICK:"dblclick",KEYUP:"keyup",KEYDOWN:"keydown",LOAD:"load",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_ENTER:"fullscreenenter",FULLSCREEN_EXIT:"fullscreenexit",FULLSCREEN_CHANGE:"fullscreenchange",WEBKIT_NEEDKEY:"webkitneedkey",METADATA:"loadedmetadata",DATA:"loadeddata",PROGRESS:"progress",TIME_UPDATE:"timeupdate",LOAD_START:"loadstart",VOLUME_CHANGE:"volumechange",PAUSE:"pause",PLAYING:"playing",PLAY:"play",WAITING:"waiting",CAN_PLAY:"canplay",ENDED:"ended",SEEKED:"seeked",SEEKING:"seeking",DURATION_CHANGE:"durationchange",BEFORE_PLAY:"beforeplay",BEFORE_PAUSE:"beforepause",STATE:"state",CUEPOINTS:"cuepoints",CUEPOINT_START:"cuepointstart",CUEPOINT_END:"cuepointend",VIEW_ENTER:"viewenter",VIEW_LEAVE:"viewleave",SOURCE:"src",RECOVER:"recover",REAP:"reap",CONFIG:"config",QUALITIES:"qualities",SET_QUALITY:"quality:set",NON_RECOVERABLE_ERROR:"error:fatal",RECOMMENDATIONS_READY:"recommendationsready",AUDIO_ONLY_SOURCE:"audioonlysource"};var n=[].slice;function t(e,n){for(var t in n)e[t]=n[t];return e}function r(e,n,t){for(n=function(e){return Array.isArray(e)?e.slice(0):e.split(".")}(n);n.length;){if(null==e)return t;e=e[n.shift()]}return null==e?t:e}function i(e){return e.emit=function(n,r,i){i=i||{};var o=function(e){var n=document.createEvent("Event");return n.initEvent(e,!1,!0),n}(n);return r&&t(o,{data:r||{}}),e.dispatchEvent(o),!1===i.return_self?o:e},e.on=function(n,t){return"string"==typeof n&&(n=n.split(" ")),n.forEach((function(n){e.addEventListener(n,t)})),e},e.off=function(n,t){return e.removeEventListener(n,t),e},e.one=e.once=function(n,t){return e.on(n,(function r(i){e.off(n,r),t(i)}))},e}var o="",u=" ",a=Array.isArray,c="undefined"!=typeof window&&i(window),s="undefined"!=typeof document&&i(document),f=["span","a","em","p","i"],l=f.concat(["div","strong","video","img","ol","ul","li","script"]),d="__flowplayer__";function p(e,n,t){var r=m(document.createElement(e));if(a(n)&&(t=n,n=!1),a(t)||(t=[t]),r.append(t.filter((function(e){return e}))),"object"!=typeof n)return r;for(var i in n)i in r?r[i]=n[i]:r.setAttribute(i,n[i]);return r}function E(e){var t=e.tagName;e[d]=1,e.find=function(n){var t=e.querySelector(n);return t?m(t):t},e.html=function(n){return e.innerHTML=n,e},e.empty=function(){return e.innerHTML=o,e},e.offset=function(){var n={top:0,left:0},t=e;do{n.left+=t.offsetLeft||0,n.top+=t.offsetTop||0}while(t=t.offsetParent);return n},e.innerWidth=function(){var n=getComputedStyle(e);return e.clientWidth-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)};var r=e.insert=function(n,t){return a(t)?t.map((function(t){return e.insert(n,t)}))[0]:m(t="string"==typeof t?e.insertAdjacentHTML(n,t):e.insertAdjacentElement?e.insertAdjacentElement(n,t):e.appendChild(t))};return e.append=r.bind(e,"beforeend"),e.prepend=r.bind(e,"afterbegin"),e.css=function(n,t){if("object"==typeof n){for(var r in n)e.css(r,n[r]);return e}return void 0===t?getComputedStyle(e)[n]:(1*t&&(t+="px"),e.style[n]=t,e)},e.show=function(){return e.css({display:~f.indexOf(t)?"inline":"block"})},e.hide=function(){return e.css({display:"none"})},e.remove=function(){var n=e.parentNode;n&&n.removeChild(e)},e.attr=function(n,t){return null==t?e.getAttribute(n):(e.setAttribute(n,t),e)},e.txt=function(n){return e.textContent=n,e},e.fp=function(n){return e.addClass("fp-"+n)},e.addClass=function(n){return n.split(u).forEach((function(n){e.hasClass(n)||(e.className+=(e.className?u:o)+n)})),e},e.removeClass=function(n){n=n.split(u);var t=e.className.split(u);return e.className=t.filter((function(e){return!~n.indexOf(e)})).join(" "),e},e.toggleClass=function(n,t){return void 0===t&&(t=!e.hasClass(n)),t?e.addClass(n):e.removeClass(n)},e.findAll=function(t){return r=e.querySelectorAll(t),n.call(r);var r},e.hasClass=function(n){return~e.className.split(u).indexOf(n)},e}function m(e){return void 0===e?e:function(e){return e&&e[d]}(e)?e:E(i(e))}function T(e,n){if("string"==typeof e&&"<"==e[0])return p(e.slice(1,-1),n);if("string"!=typeof e)return m(e);var t=n instanceof HTMLElement&&n.querySelector(".fp-"+e)||document.querySelector(e);return t?m(t):void 0}T.window=c,T.document=s,T.el=p,l.forEach((function(e){T[e]=function(n,t){return"string"==typeof n&&(n={class:n}),p(e,n,t)}}));var v=window.VTTCue||window.TextTrackCue;function C(r,i,o){var u=r.startTime||r.start,a=r.endTime||r.end,c=r.text||"";try{var s=new v(u,a,c);return function(){var e=n.call(arguments),r=e.shift();e.reduce(t,r)}(s,{id:i.toString()},r),s.onenter=o.emit.bind(o,e.CUEPOINT_START,{cuepoint:r}),s.onexit=o.emit.bind(o,e.CUEPOINT_END,{cuepoint:r}),s}catch(e){if(u===a)return console.warn("Cue(:error)> startTime cannot equal endTime on this platform");throw e}}function A(e,n){e.cues&&e.cues.length&&[].slice.call(e.cues).forEach(n)}return function(e,n){if("object"==typeof exports&&"undefined"!=typeof module)return n;"flowplayer"in e||(e.flowplayer={extensions:[]});var t=e.flowplayer;return"function"==typeof t?(t(n),n):(Array.isArray(t.extensions)||(t.extensions=[]),~t.extensions.indexOf(n)||t.extensions.push(n),n)}(window,(function(n,t,i){var o=i.addTextTrack("metadata","fp-cuepoints");i.reaper.put("cuepoints",[]),i.on(e.CONFIG,(function(t){r(t,"data.cuepoints",[])!==i.cuepoints&&i.emit(e.CUEPOINTS,{cuepoints:n.cuepoints})})),i.on(["cuepoints:redraw",e.DURATION_CHANGE],(function(){n.draw_cuepoints&&t.timeline&&function(e,n,t){if(e){var r=n.duration;if(isFinite(r))e.findAll(".fp-cuepoint").forEach((function(e){e.remove()})),A(t,(function(n,t){var i=Math.round(n.startTime/r*1e3)/10,o=T.span("fp-cuepoint");if(i>100||i<0)return console.warn("Cuepoint("+t+") does not have a valid startTime("+n.startTime+") ");o.css("left",i+"%");var u=(n.endTime-n.startTime)/r*100;o.css("width",u+"%"),e.append(o)}))}}(t.timeline,i,o)})),i.on(e.CUEPOINTS,(function(e){var n=r(e,"data.cuepoints");i.reaper.put("cuepoints",n),A(o,(function(e){e&&o.removeCue(e)})),n.map((function(e,n){return C(e,"cuepoint-"+n,i)})).forEach((function(e){o.addCue(e)})),i.emit("cuepoints:redraw")}))}))}));
