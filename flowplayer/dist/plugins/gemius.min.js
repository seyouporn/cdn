!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((e=e||self).flowplayer=e.flowplayer||{},e.flowplayer.gemius=n())}(this,(function(){"use strict";function e(e,n,o){for(n=function(e){return Array.isArray(e)?e.slice(0):e.split(".")}(n);n.length;){if(null==e)return o;e=e[n.shift()]}return null==e?o:e}var n={MOUNT:"mount",ERROR:"error",CONTEXT_MENU:"contextmenu",CLICK:"click",DBL_CLICK:"dblclick",KEYUP:"keyup",KEYDOWN:"keydown",LOAD:"load",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",RESIZE:"resize",SCROLL:"scroll",FULLSCREEN_ENTER:"fullscreenenter",FULLSCREEN_EXIT:"fullscreenexit",FULLSCREEN_CHANGE:"fullscreenchange",WEBKIT_NEEDKEY:"webkitneedkey",METADATA:"loadedmetadata",DATA:"loadeddata",PROGRESS:"progress",TIME_UPDATE:"timeupdate",LOAD_START:"loadstart",VOLUME_CHANGE:"volumechange",PAUSE:"pause",PLAYING:"playing",PLAY:"play",WAITING:"waiting",CAN_PLAY:"canplay",ENDED:"ended",SEEKED:"seeked",SEEKING:"seeking",DURATION_CHANGE:"durationchange",BEFORE_PLAY:"beforeplay",BEFORE_PAUSE:"beforepause",STATE:"state",CUEPOINTS:"cuepoints",CUEPOINT_START:"cuepointstart",CUEPOINT_END:"cuepointend",VIEW_ENTER:"viewenter",VIEW_LEAVE:"viewleave",SOURCE:"src",RECOVER:"recover",REAP:"reap",CONFIG:"config",QUALITIES:"qualities",SET_QUALITY:"quality:set",NON_RECOVERABLE_ERROR:"error:fatal",RECOMMENDATIONS_READY:"recommendationsready",AUDIO_ONLY_SOURCE:"audioonlysource"},o=["playerID","gemiusID"],a=["programID","additionalParameters.programName","additionalParameters.programType"],r=["adName","adDuration","adType","campaignClassification","quality","resolution","volume"];function t(n,o){var a=[];return o.forEach((function(o){void 0===e(n,o)&&a.push(o)})),a.length&&console.warn("Missing Gemius configuration: ",a.join(", ")),0===a.length}return function(e,n){if("object"==typeof exports&&"undefined"!=typeof module)return n;"flowplayer"in e||(e.flowplayer={extensions:[]});var o=e.flowplayer;return"function"==typeof o?(o(n),n):(Array.isArray(o.extensions)||(o.extensions=[]),~o.extensions.indexOf(n)||o.extensions.push(n),n)}(window,(function(i,u,E){if("function"!=typeof GemiusPlayer)return console.warn("Gemius SDK needs to be loaded prior loading gemius plugin");var s,l=flowplayer.util.extend,d=e(i,"gemius.playerID"),c=e(i,"gemius.gemiusID"),f=e(i,"gemius.additionalParameters",{});if(t(e(i,"gemius",{}),o)){var p=new GemiusPlayer(d,c,f);p.setVideoObject(E),E.on(n.REAP,(function(){T("stop"),p=void 0,window.removeEventListener("beforeunload",y)})),E.on(n.CONFIG,(function(n){s=e(n.data,"gemius",{})})),E.on(n.METADATA,(function(){t(s,a)&&p.newProgram(s.programID,s.additionalParameters)})),window.addEventListener("beforeunload",y);var m={};if(m[n.PLAY]="play",m[n.PAUSE]="pause",m[n.WAITING]="buffer",m[n.SEEKING]="seek",m[n.ENDED]="complete",E.on(Object.keys(m),(function(e){p.programEvent(s.programID,E.currentTime,m[e.type])})),E.ads){var A=flowplayer.AdEvents;E.ads.on(A.AD_STARTED,(function(e){var n;p.newAd(e.vast_ad_id,(n=l(l({},f),function(e){return{adDuration:e.ad.duration,adType:e.ad_type,resolution:e.ad.width+"x"+e.ad.height,volume:e.volume}}(e)),r.reduce((function(e,o){return n&&n.hasOwnProperty(o)&&(e[o]=n[o]),e}),{}))),p.adEvent(s.programID,e.vast_ad_id,E.currentTime,"play",{autoPlay:e.autoPlay,volume:e.volume})})),[A.AD_PAUSED,A.AD_COMPLETED].forEach((function(e){var n;switch(e){case A.AD_PAUSED:n="pause";break;case A.AD_COMPLETED:n="complete"}E.ads.on(e,(function(e){p.adEvent(s.programID,e.vast_ad_id,E.currentTime,n)}))}))}}function T(e){(E.ads&&E.ads.adPlaying()?p.adEvent:p.programEvent).call(p,s.programID,E.currentTime,e)}function y(){T("close")}}))}));
